---
import { db } from "~/contacts";
import { flash } from "~/flash";
if (Astro.request.method !== "POST") {
	return new Response("Method not allowed", {
		status: 405,
		statusText: "Method not allowed",
	});
}

const contactId = Number(Astro.params.contactId);
if (!contactId || Number.isNaN(contactId)) {
	return new Response("Not found.", {
		status: 404,
		statusText: "Not found",
	});
}

await db.delete(contactId);
flash.success("Contact deleted.");
return Astro.redirect("/contacts");
---
